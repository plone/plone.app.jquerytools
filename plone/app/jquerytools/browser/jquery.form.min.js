(function(b){function N(a){var e=a.data;if(!a.isDefaultPrevented()){a.preventDefault();b(this).ajaxSubmit(e)}}function O(a){var e=a.target,i=b(e);if(!i.is(":submit,input:image")){e=i.closest(":submit");if(e.length===0)return;e=e[0]}var f=this;f.clk=e;if(e.type=="image")if(a.offsetX!==undefined){f.clk_x=a.offsetX;f.clk_y=a.offsetY}else if(typeof b.fn.offset=="function"){i=i.offset();f.clk_x=a.pageX-i.left;f.clk_y=a.pageY-i.top}else{f.clk_x=a.pageX-e.offsetLeft;f.clk_y=a.pageY-e.offsetTop}setTimeout(function(){f.clk=
f.clk_x=f.clk_y=null},100)}function r(){if(b.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log)window.console.log(a);else window.opera&&window.opera.postError&&window.opera.postError(a)}}var H={};H.fileapi=b("<input type='file'/>").get(0).files!==undefined;H.formdata=window.FormData!==undefined;b.fn.ajaxSubmit=function(a){function e(l){for(var y=new FormData,C=0;C<l.length;C++)y.append(l[C].name,l[C].value);if(a.extraData)for(var t in a.extraData)a.extraData.hasOwnProperty(t)&&
y.append(t,a.extraData[t]);a.data=null;l=b.extend(true,{},b.ajaxSettings,a,{contentType:false,processData:false,cache:false,type:"POST"});if(a.uploadProgress)l.xhr=function(){var v=jQuery.ajaxSettings.xhr();if(v.upload)v.upload.onprogress=function(c){var z=0,F=c.loaded||c.position,w=c.total;if(c.lengthComputable)z=Math.ceil(F/w*100);a.uploadProgress(c,F,w,z)};return v};l.data=null;var p=l.beforeSend;l.beforeSend=function(v,c){c.data=y;p&&p.call(c,v,a)};b.ajax(l)}function i(l){function y(h){return h=
h.contentWindow?h.contentWindow.document:h.contentDocument?h.contentDocument:h.document}function C(){function h(){try{var G=y(D).readyState;r("state = "+G);G&&G.toLowerCase()=="uninitialized"&&setTimeout(h,50)}catch(I){r("Server abort: ",I," (",I.name,")");t(P);J&&clearTimeout(J);J=undefined}}var j=m.attr("target"),u=m.attr("action");p.setAttribute("target",F);f||p.setAttribute("method","POST");u!=c.url&&p.setAttribute("action",c.url);if(!c.skipEncodingOverride&&(!f||/post/i.test(f)))m.attr({encoding:"multipart/form-data",
enctype:"multipart/form-data"});if(c.timeout)J=setTimeout(function(){Q=true;t(R)},c.timeout);var A=[];try{if(c.extraData)for(var x in c.extraData)c.extraData.hasOwnProperty(x)&&A.push(b('<input type="hidden" name="'+x+'">').attr("value",c.extraData[x]).appendTo(p)[0]);if(!c.iframeTarget){w.appendTo("body");D.attachEvent?D.attachEvent("onload",t):D.addEventListener("load",t,false)}setTimeout(h,15);p.submit()}finally{p.setAttribute("action",u);j?p.setAttribute("target",j):m.removeAttr("target");b(A).remove()}}
function t(h){if(!(g.aborted||S)){try{s=y(D)}catch(j){r("cannot access response document: ",j);h=P}if(h===R&&g)g.abort("timeout");else if(h==P&&g)g.abort("server abort");else{if(!s||s.location.href==c.iframeSrc)if(!Q)return;D.detachEvent?D.detachEvent("onload",t):D.removeEventListener("load",t,false);h="success";var u;try{if(Q)throw"timeout";var A=c.dataType=="xml"||s.XMLDocument||b.isXMLDoc(s);r("isXml="+A);if(!A&&window.opera&&(s.body===null||!s.body.innerHTML))if(--V){r("requeing onLoad callback, DOM not available");
setTimeout(t,250);return}var x=s.body?s.body:s.documentElement;g.responseText=x?x.innerHTML:null;g.responseXML=s.XMLDocument?s.XMLDocument:s;if(A)c.dataType="xml";g.getResponseHeader=function(W){var X={"content-type":c.dataType};return X[W]};if(x){g.status=Number(x.getAttribute("status"))||g.status;g.statusText=x.getAttribute("statusText")||g.statusText}var G=(c.dataType||"").toLowerCase(),I=/(json|script|text)/.test(G);if(I||c.textarea){var K=s.getElementsByTagName("textarea")[0];if(K){g.responseText=
K.value;g.status=Number(K.getAttribute("status"))||g.status;g.statusText=K.getAttribute("statusText")||g.statusText}else if(I){var L=s.getElementsByTagName("pre")[0],M=s.getElementsByTagName("body")[0];if(L)g.responseText=L.textContent?L.textContent:L.innerText;else if(M)g.responseText=M.textContent?M.textContent:M.innerText}}else if(G=="xml"&&!g.responseXML&&g.responseText)g.responseXML=Y(g.responseText);try{T=Z(g,G,c)}catch($){h="parsererror";g.error=u=$||h}}catch(U){r("error caught: ",U);h="error";
g.error=u=U||h}if(g.aborted){r("upload aborted");h=null}if(g.status)h=g.status>=200&&g.status<300||g.status===304?"success":"error";if(h==="success"){c.success&&c.success.call(c.context,T,"success",g);z&&b.event.trigger("ajaxSuccess",[g,c])}else if(h){if(u===undefined)u=g.statusText;c.error&&c.error.call(c.context,g,h,u);z&&b.event.trigger("ajaxError",[g,c,u])}z&&b.event.trigger("ajaxComplete",[g,c]);z&&!--b.active&&b.event.trigger("ajaxStop");c.complete&&c.complete.call(c.context,g,h);S=true;c.timeout&&
clearTimeout(J);setTimeout(function(){c.iframeTarget||w.remove();g.responseXML=null},100)}}}var p=m[0],v,c,z,F,w,D,g,B,Q,J;B=!!b.fn.prop;if(b(":input[name=submit],:input[id=submit]",p).length)alert('Error: Form elements must not have name or id of "submit".');else{if(l)for(v=0;v<q.length;v++){l=b(q[v]);B?l.prop("disabled",false):l.removeAttr("disabled")}c=b.extend(true,{},b.ajaxSettings,a);c.context=c.context||c;F="jqFormIO"+(new Date).getTime();if(c.iframeTarget){w=b(c.iframeTarget);if(l=w.attr("name"))F=
l;else w.attr("name",F)}else{w=b('<iframe name="'+F+'" src="'+c.iframeSrc+'" />');w.css({position:"absolute",top:"-1000px",left:"-1000px"})}D=w[0];g={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(h){var j=h==="timeout"?"timeout":"aborted";r("aborting upload... "+j);this.aborted=1;w.attr("src",c.iframeSrc);g.error=j;c.error&&c.error.call(c.context,g,j,h);z&&b.event.trigger("ajaxError",
[g,c,j]);c.complete&&c.complete.call(c.context,g,j)}};(z=c.global)&&0===b.active++&&b.event.trigger("ajaxStart");z&&b.event.trigger("ajaxSend",[g,c]);if(c.beforeSend&&c.beforeSend.call(c.context,g,c)===false)c.global&&b.active--;else if(!g.aborted){if(B=p.clk)if((l=B.name)&&!B.disabled){c.extraData=c.extraData||{};c.extraData[l]=B.value;if(B.type=="image"){c.extraData[l+".x"]=p.clk_x;c.extraData[l+".y"]=p.clk_y}}var R=1,P=2;B=b("meta[name=csrf-token]").attr("content");if((l=b("meta[name=csrf-param]").attr("content"))&&
B){c.extraData=c.extraData||{};c.extraData[l]=B}c.forceSync?C():setTimeout(C,10);var T,s,V=50,S,Y=b.parseXML||function(h,j){if(window.ActiveXObject){j=new ActiveXObject("Microsoft.XMLDOM");j.async="false";j.loadXML(h)}else j=(new DOMParser).parseFromString(h,"text/xml");return j&&j.documentElement&&j.documentElement.nodeName!="parsererror"?j:null},aa=b.parseJSON||function(h){return window.eval("("+h+")")},Z=function(h,j,u){var A=h.getResponseHeader("content-type")||"",x=j==="xml"||!j&&A.indexOf("xml")>=
0;h=x?h.responseXML:h.responseText;x&&h.documentElement.nodeName==="parsererror"&&b.error&&b.error("parsererror");if(u&&u.dataFilter)h=u.dataFilter(h,j);if(typeof h==="string")if(j==="json"||!j&&A.indexOf("json")>=0)h=aa(h);else if(j==="script"||!j&&A.indexOf("javascript")>=0)b.globalEval(h);return h}}}}if(!this.length){r("ajaxSubmit: skipping submit process - no element selected");return this}var f,d,m=this;if(typeof a=="function")a={success:a};f=this.attr("method");d=this.attr("action");if(d=(d=
typeof d==="string"?b.trim(d):"")||window.location.href||"")d=(d.match(/^([^#]+)/)||[])[1];a=b.extend(true,{url:d,success:b.ajaxSettings.success,type:f||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a);d={};this.trigger("form-pre-serialize",[this,a,d]);if(d.veto){r("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(a.beforeSerialize&&a.beforeSerialize(this,a)===false){r("ajaxSubmit: submit aborted via beforeSerialize callback");
return this}var o=a.traditional;if(o===undefined)o=b.ajaxSettings.traditional;var q=[],n,k=this.formToArray(a.semantic,q);if(a.data){a.extraData=a.data;n=b.param(a.data,o)}if(a.beforeSubmit&&a.beforeSubmit(k,this,a)===false){r("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[k,this,a,d]);if(d.veto){r("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}d=b.param(k,o);if(n)d=d?d+"&"+n:n;if(a.type.toUpperCase()=="GET"){a.url+=
(a.url.indexOf("?")>=0?"&":"?")+d;a.data=null}else a.data=d;var E=[];a.resetForm&&E.push(function(){m.resetForm()});a.clearForm&&E.push(function(){m.clearForm(a.includeHidden)});if(!a.dataType&&a.target){var ba=a.success||function(){};E.push(function(l){var y=a.replaceTarget?"replaceWith":"html";b(a.target)[y](l).each(ba,arguments)})}else a.success&&E.push(a.success);a.success=function(l,y,C){for(var t=a.context||a,p=0,v=E.length;p<v;p++)E[p].apply(t,[l,y,C||m,m])};n=b("input:file:enabled[value]",
this);n=n.length>0;d="multipart/form-data";d=m.attr("enctype")==d||m.attr("encoding")==d;o=H.fileapi&&H.formdata;r("fileAPI :"+o);var ca=(n||d)&&!o;if(a.iframe!==false&&(a.iframe||ca))a.closeKeepAlive?b.get(a.closeKeepAlive,function(){i(k)}):i(k);else(n||d)&&o?e(k):b.ajax(a);for(n=0;n<q.length;n++)q[n]=null;this.trigger("form-submit-notify",[this,a]);return this};b.fn.ajaxForm=function(a){a=a||{};a.delegation=a.delegation&&b.isFunction(b.fn.on);if(!a.delegation&&this.length===0){var e={s:this.selector,
c:this.context};if(!b.isReady&&e.s){r("DOM not ready, queuing ajaxForm");b(function(){b(e.s,e.c).ajaxForm(a)});return this}r("terminating; zero elements found by selector"+(b.isReady?"":" (DOM not ready)"));return this}if(a.delegation){b(document).off("submit.form-plugin",this.selector,N).off("click.form-plugin",this.selector,O).on("submit.form-plugin",this.selector,a,N).on("click.form-plugin",this.selector,a,O);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",a,N).bind("click.form-plugin",
a,O)};b.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};b.fn.formToArray=function(a,e){var i=[];if(this.length===0)return i;var f=this[0],d=a?f.getElementsByTagName("*"):f.elements;if(!d)return i;var m,o,q,n,k,E;m=0;for(E=d.length;m<E;m++){k=d[m];if(q=k.name)if(a&&f.clk&&k.type=="image"){if(!k.disabled&&f.clk==k){i.push({name:q,value:b(k).val(),type:k.type});i.push({name:q+".x",value:f.clk_x},{name:q+".y",value:f.clk_y})}}else if((n=b.fieldValue(k,true))&&
n.constructor==Array){e&&e.push(k);o=0;for(k=n.length;o<k;o++)i.push({name:q,value:n[o]})}else if(H.fileapi&&k.type=="file"&&!k.disabled){e&&e.push(k);n=k.files;if(n.length)for(o=0;o<n.length;o++)i.push({name:q,value:n[o],type:k.type});else i.push({name:q,value:"",type:k.type})}else if(n!==null&&typeof n!="undefined"){e&&e.push(k);i.push({name:q,value:n,type:k.type,required:k.required})}}if(!a&&f.clk){a=b(f.clk);e=a[0];if((q=e.name)&&!e.disabled&&e.type=="image"){i.push({name:q,value:a.val()});i.push({name:q+
".x",value:f.clk_x},{name:q+".y",value:f.clk_y})}}return i};b.fn.formSerialize=function(a){return b.param(this.formToArray(a))};b.fn.fieldSerialize=function(a){var e=[];this.each(function(){var i=this.name;if(i){var f=b.fieldValue(this,a);if(f&&f.constructor==Array)for(var d=0,m=f.length;d<m;d++)e.push({name:i,value:f[d]});else f!==null&&typeof f!="undefined"&&e.push({name:this.name,value:f})}});return b.param(e)};b.fn.fieldValue=function(a){for(var e=[],i=0,f=this.length;i<f;i++){var d=this[i];d=
b.fieldValue(d,a);d===null||typeof d=="undefined"||d.constructor==Array&&!d.length||(d.constructor==Array?b.merge(e,d):e.push(d))}return e};b.fieldValue=function(a,e){var i=a.name,f=a.type,d=a.tagName.toLowerCase();if(e===undefined)e=true;if(e&&(!i||a.disabled||f=="reset"||f=="button"||(f=="checkbox"||f=="radio")&&!a.checked||(f=="submit"||f=="image")&&a.form&&a.form.clk!=a||d=="select"&&a.selectedIndex==-1))return null;if(d=="select"){d=a.selectedIndex;if(d<0)return null;e=[];a=a.options;i=(f=f==
"select-one")?d+1:a.length;for(d=f?d:0;d<i;d++){var m=a[d];if(m.selected){var o=m.value;o||(o=m.attributes&&m.attributes.value&&!m.attributes.value.specified?m.text:m.value);if(f)return o;e.push(o)}}return e}return b(a).val()};b.fn.clearForm=function(a){return this.each(function(){b("input,select,textarea",this).clearFields(a)})};b.fn.clearFields=b.fn.clearInputs=function(a){var e=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var i=
this.type,f=this.tagName.toLowerCase();if(e.test(i)||f=="textarea")this.value="";else if(i=="checkbox"||i=="radio")this.checked=false;else if(f=="select")this.selectedIndex=-1;else if(a)if(a===true&&/hidden/.test(i)||typeof a=="string"&&b(this).is(a))this.value=""})};b.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)this.reset()})};b.fn.enable=function(a){if(a===undefined)a=true;return this.each(function(){this.disabled=
!a})};b.fn.selected=function(a){if(a===undefined)a=true;return this.each(function(){var e=this.type;if(e=="checkbox"||e=="radio")this.checked=a;else if(this.tagName.toLowerCase()=="option"){e=b(this).parent("select");a&&e[0]&&e[0].type=="select-one"&&e.find("option").selected(false);this.selected=a}})};b.fn.ajaxSubmit.debug=false})(jQuery);

